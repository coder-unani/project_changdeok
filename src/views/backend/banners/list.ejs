<div class="mt-2">
  <h1 class='flex justify-start items-center gap-1.5 py-2 text-center text-slate-700 transition-all'>
    <span class="text-2xl font-semibold"><%=title%></span>
  </h1>
</div>

<div class="py-2 mb-2">
  <div class="flex justify-between items-center">
    <div>
      <a href="<%=backendRoutes.banners.write.url%>?gp=<%=metadata.groupInfo.id%>&sq=<%=metadata.seq%>" class="orb-btn orb-btn-primary">신규 등록</a>
    </div>
    <div class="flex-1 flex justify-end">
      <div class="relative w-full lg:max-w-[200px] ml-4">
        <input
        class="w-full pr-11 pl-4 py-3 bg-gray-200 text-gray-700 text-sm placeholder:text-gray-400 rounded-lg transition duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-200"
        placeholder="게시물 검색"
        />
        <button
        class="absolute h-8 w-8 inset-y-0 right-2 my-auto px-2 flex items-center bg-transparent rounded"
        type="button"
        >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-8 h-8 text-gray-600">
          <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
        </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<div class="orb-list">
  <div class="bg-white p-4 mb-4 lg:p-6 rounded-xl shadow-[0_2px_30px_rgba(0,0,0,.06)] overflow-x-auto">
    <table class="table-fixed">
      <thead>
      <tr>
        <th class="w-24 min-w-24 text-center"><p class="text-xs lg:text-[13px] font-normal leading-none text-gray-500">번호</p></th>
        <th class="w-36 min-w-[132px] text-center"><p class="text-xs lg:text-[13px] font-normal leading-none text-gray-500">이미지</p></th>
        <th class="w-auto min-w-[280px] text-center"><p class="text-xs lg:text-[13px] font-normal leading-none text-gray-500">상세정보</p></th>
        <th class="w-[160px] min-w-[160px] text-center"><p class="text-xs lg:text-[13px] font-normal leading-none text-gray-500">발행 기간</p></th>
        <th class="w-[100px] min-w-[100px] text-center"><p class="text-xs lg:text-[13px] font-normal leading-none text-gray-500">발행 여부</p></th>
      </tr>
      </thead>
      <tbody>
        <% if (data.length === 0) { %>
          <tr>
            <td colspan="5" class="py-6 text-center"><p class="text-gray-400">등록된 배너가 없습니다.</p></td>
          </tr>
        <% } else { %>
        <% data.forEach(banner => { %>
          <tr>
            <td class="text-center">
              <p><%=banner.id%></p>
            </td>
            <td class="flex justify-center flex-none text-center">
              <img src="<%=banner.imagePath || '/images/no-image-200x200.jpg'%>" class="w-[100px] h-[100px] object-cover rounded-md cursor-pointer" alt="이미지" />
            </td>
            <td>
              <div>
                <p class="text-sm font-semibold break-keep mb-1.5"><a href="<%=backendRoutes.banners.detail.url.replace(':bannerId', banner.id)%>" class="hover:underline decoration-gray-800"><%=banner.title%></a></p>
                <p class="text-[13px] text-gray-400"><%=banner.description%></p>
              </div>
            </td>
            <td class="text-center">
              <!-- <p class="hidden lg:block"><%=banner.publishedAt%> ~ <%=banner.unpublishedAt%></p> -->
              <p class="hidden lg:block text-xs">
                <span class="block"><%= banner.publishedAt ? banner.publishedAt.slice(0, -3) : '' %></span>
                <span class="block">~ <%= banner.unpublishedAt ? banner.unpublishedAt.slice(0, -3) : '' %></span>
              </p>
              <p class="block lg:hidden text-xs">
                <span class="block"><%= banner.publishedAt ? banner.publishedAt.slice(0, -3) : '' %></span>
                <span class="block">~ <%= banner.unpublishedAt ? banner.unpublishedAt.slice(0, -3) : '' %></span>
              </p>
            </td>
            <td class="text-center">
              <% if (!banner.isPublished) { %> 
                <span class="px-2.5 py-1 bg-amber-100 rounded-full text-sm font-medium text-amber-500">미발행</span>
              <% } else if (banner.publishedAt <= new Date().toISOString() && (!banner.unpublishedAt || banner.unpublishedAt >= new Date().toISOString())) { %>
                <span class="px-2.5 py-1 bg-emerald-100 rounded-full text-sm font-medium text-emerald-500">발행중</span>
              <% } else if (banner.publishedAt > new Date().toISOString()) { %>
                <span class="px-2.5 py-1 bg-blue-100 rounded-full text-sm font-medium text-blue-500">예약</span>
              <% } else { %>
                <span class="px-2.5 py-1 bg-gray-100 rounded-full text-sm font-medium text-gray-500">종료</span>
              <% } %>
            </td>
          </tr>
        <% }); } %>
      </tbody>
    </table>
  </div>
  <!-- 페이지 버튼 -->
  <% if (metadata.totalPage >= 1) { %>
    <div class="bg-white py-2 lg:py-4 rounded-xl shadow-[0_2px_30px_rgba(0,0,0,.06)]">  
      <div class="flex justify-center space-x-1">
        <% if (metadata.page > 1) { %><button><a href="?page=<%=metadata.page - 1%>">이전</a></button><% } %>
        <% 
          let startPage = metadata.page - 2;
          if (startPage < 1) startPage = 1;
          const endPage = metadata.page + 2 > metadata.totalPage ? metadata.totalPage : metadata.page + 2;
          for (let i = startPage; i <= endPage; i++) { 
        %> 
          <button class="<%if (i === metadata.page) {%>active<%}%>"><a href="?page=<%=i%>"><%=i%></a></button>
        <% } %>
        <% if (metadata.page < metadata.totalPage) { %><button><a href="?page=<%=metadata.page + 1%>">다음</a></button><% } %>
      </div>
    </div>
  <% } %>
</div>