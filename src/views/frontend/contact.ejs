<div class="relative h-[50vh] w-full pt-[56px] lg:h-[460px]">
  <div
    class="bg- absolute inset-0 -z-10 h-full w-full bg-[url('/images/banner-contact.webp')] bg-cover bg-fixed bg-center"
  >
    <div class="absolute inset-0 h-full w-full bg-black opacity-50"></div>
  </div>
  <div class="m-auto h-full w-full max-w-[1280px] px-10">
    <div class="flex h-full flex-col items-center justify-center gap-8 py-20">
      <p class="mb-2 text-center break-keep text-white">
        <span class="text-2xl lg:text-[48px]">
          <strong><%=routes.contact.title%></strong>
        </span>
      </p>
      <p class="font-oswald text-center text-base break-keep text-white lg:text-xl">
        <span>아래 양식을 작성해 보내주시면 최대한 빨리 연락드리겠습니다.</span>
      </p>
    </div>
  </div>
</div>

<!-- 문의 폼 -->
<div class="w-full">
  <div class="m-auto flex w-full max-w-[1280px] flex-none flex-col gap-14 px-4 py-10 lg:flex-row lg:px-10 lg:py-20">
    <div class="flex w-full flex-col space-y-8 lg:max-w-[380px]">
      <div class="w-full space-y-2.5 bg-sky-50 px-12 py-8 text-sky-700">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="h-6 w-6 lg:h-8 lg:w-8">
          <path
            d="M164.9 24.6c-7.7-18.6-28-28.5-47.4-23.2l-88 24C12.1 30.2 0 46 0 64C0 311.4 200.6 512 448 512c18 0 33.8-12.1 38.6-29.5l24-88c5.3-19.4-4.6-39.7-23.2-47.4l-96-40c-16.3-6.8-35.2-2.1-46.3 11.6L304.7 368C234.3 334.7 177.3 277.7 144 207.3L193.3 167c13.7-11.2 18.4-30 11.6-46.3l-40-96z"
          />
        </svg>
        <p class="text-lg font-semibold break-keep lg:text-2xl">대표전화</p>
        <p class="text-base break-keep text-black lg:text-lg"><%=company.tel%></p>
      </div>
      <div class="w-full space-y-2.5 bg-sky-50 px-12 py-8 text-sky-700">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="h-6 w-6 lg:h-8 lg:w-8">
          <path
            d="M128 64l0 96 64 0 0-96 194.7 0L416 93.3l0 66.7 64 0 0-66.7c0-17-6.7-33.3-18.7-45.3L432 18.7C420 6.7 403.7 0 386.7 0L192 0c-35.3 0-64 28.7-64 64zM0 160L0 480c0 17.7 14.3 32 32 32l32 0c17.7 0 32-14.3 32-32l0-320c0-17.7-14.3-32-32-32l-32 0c-17.7 0-32 14.3-32 32zm480 32l-352 0 0 288c0 17.7 14.3 32 32 32l320 0c17.7 0 32-14.3 32-32l0-256c0-17.7-14.3-32-32-32zM256 256a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm32 96a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM224 416a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"
          />
        </svg>
        <p class="text-lg font-semibold break-keep lg:text-2xl">팩스</p>
        <p class="text-base break-keep text-black lg:text-lg"><%=company.fax%></p>
      </div>
      <div class="w-full space-y-2.5 bg-sky-50 px-12 py-8 text-sky-700">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor" class="h-6 w-6 lg:h-8 lg:w-8">
          <path
            d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"
          />
        </svg>
        <p class="text-lg font-semibold break-keep lg:text-2xl">이메일</p>
        <p class="text-base break-keep text-black lg:text-lg"><%=company.email%></p>
      </div>
      <div class="w-full space-y-2.5 bg-sky-50 px-12 py-8 text-sky-700">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" fill="currentColor" class="h-6 w-6 lg:h-8 lg:w-8">
          <path
            d="M48 0C21.5 0 0 21.5 0 48L0 464c0 26.5 21.5 48 48 48l96 0 0-80c0-26.5 21.5-48 48-48s48 21.5 48 48l0 80 96 0c26.5 0 48-21.5 48-48l0-416c0-26.5-21.5-48-48-48L48 0zM64 240c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zm112-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zM80 96l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zM272 96l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16z"
          />
        </svg>
        <p class="text-lg font-semibold break-keep lg:text-2xl">법률 사무소 주소</p>
        <p class="text-base break-keep text-black lg:text-lg"><%=company.address%></p>
      </div>
    </div>

    <div class="w-full">
      <div class="flex w-full flex-col justify-between pb-10 lg:flex-row lg:items-end">
        <h3 class="mb-4 text-2xl font-semibold lg:mb-0 lg:text-[36px]">
          <p>온라인 상담</p>
        </h3>
      </div>
      <form id="formContact" action="" class="space-y-4">
        <!-- 이름 -->
        <div class="space-y-2 text-sm">
          <div class="text-sm font-medium">
            <label for="name">이름</label>
            <span class="text-rose-500">*</span>
          </div>
          <input
            type="text"
            id="name"
            name="name"
            class="w-full rounded-full border border-zinc-400 px-4 py-2 font-semibold placeholder:text-zinc-400 focus:ring-2 focus:ring-sky-500 focus:outline-none"
            placeholder="이름을 입력해주세요."
            required
          />
        </div>
        <!-- 이메일 -->
        <div class="space-y-2 text-sm">
          <div class="text-sm font-medium">
            <label for="email">이메일</label>
            <span class="text-rose-500">*</span>
          </div>
          <input
            type="email"
            id="email"
            name="email"
            class="w-full rounded-full border border-zinc-400 px-4 py-2 font-semibold placeholder:text-zinc-400 focus:ring-2 focus:ring-sky-500 focus:outline-none"
            placeholder="이메일을 입력해주세요."
            required
          />
        </div>
        <!-- 연락처 -->
        <div class="space-y-2 text-sm">
          <div class="text-sm font-medium">
            <label for="phone">연락처</label>
          </div>
          <input
            type="text"
            id="phone"
            name="phone"
            class="w-full rounded-full border border-zinc-400 px-4 py-2 font-semibold placeholder:text-zinc-400 focus:ring-2 focus:ring-sky-500 focus:outline-none"
            placeholder="연락처를 입력해주세요."
          />
        </div>
        <!-- 업무분야 -->
        <div class="space-y-2 text-sm">
          <div class="text-sm font-medium">
            <label for="subject">업무분야</label>
          </div>
          <div class="rounded-full border border-zinc-400">
            <select
              name="subject"
              id="subject"
              class="w-full rounded-full border-r-12 border-transparent px-4 py-2 font-semibold placeholder:text-zinc-400 focus:ring-2 focus:ring-sky-500 focus:outline-none"
            >
              <option value="">업무분야를 선택해주세요.</option>
              <option value="치명적 상해사고">치명적 상해사고</option>
              <option value="대형 교통사고">대형 교통사고</option>
              <option value="의료사고">의료사고</option>
              <option value="보행자 및 자전거 사고">보행자 및 자전거 사고</option>
              <option value="구내 상해사고">구내 상해사고</option>
              <option value="개에게 물림 사고">개에게 물림 사고</option>
              <option value="제조물 책임">제조물 책임</option>
              <option value="기타">기타</option>
            </select>
          </div>
        </div>
        <!-- 내용 -->
        <div class="space-y-2 text-sm">
          <div class="text-sm font-medium">
            <label for="content">상담 내용</label>
            <span class="text-rose-500">*</span>
          </div>
          <textarea
            id="content"
            name="content"
            class="min-h-[160px] w-full rounded-xl border border-zinc-400 px-4 py-2 font-semibold placeholder:text-sm placeholder:text-zinc-400 focus:ring-2 focus:ring-sky-500 focus:outline-none"
            placeholder="상담하실 내용을 작성해주세요."
            required
          ></textarea>
        </div>
        <!-- 전송 -->
        <div class="text-center">
          <button type="submit" class="cursor-pointer border border-black bg-white px-6 py-3 text-xs font-semibold">
            상담 신청
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script nonce="<%=nonce%>">
  document.addEventListener('DOMContentLoaded', () => {
    // 폼 데이터 전송
    document.getElementById('formContact').addEventListener('submit', async (e) => {
      e.preventDefault();

      try {
        // TODO: 폼 데이터 유효성 검사
        // isNonUserWrite, isEncrypt = true;

        // 폼 데이터 수집
        const formData = new FormData(e.target);

        // 폼 데이터 변환
        const data = {};
        formData.forEach((value, key) => {
          data[key] = value;
        });

        const formatData = {
          title: data.subject,
          content: `
          이름: ${data.name}<br>
          이메일: ${data.email}<br>
          연락처: ${data.phone}<br>
          업무분야: ${data.subject}<br>
          내용: ${data.content}
        `,
        };

        // 콘텐츠 저장 API 호출
        const groupId = '<%=metadata.content.group.id%>';
        const saveUrl = '<%=apiRoutes.contents.write.url%>'.replace(':groupId', groupId);

        const response = await fetch(saveUrl, {
          method: '<%=apiRoutes.contents.write.method%>',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(formatData),
        });

        // 응답 오류
        if (!response.ok) {
          throw new Error('상담 신청에 실패하였습니다.');
        }

        // 응답 성공
        alert('상담 신청이 완료되었습니다. 빠른 시일 내에 연락드리겠습니다.');
      } catch (err) {
        alert('상담 신청에 실패하였습니다. 다시 시도해주세요.');
      }
    });
  });
</script>
